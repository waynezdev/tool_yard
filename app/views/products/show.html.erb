<h1>This is the show page</h1>

  <% if flash[:message] %>
    <h2><div class="message"><%= flash[:message] %></div></h2>
  <% end %>

<h2>delete this json later</h2><%= @product.to_json %> <%# used for testing only delete%>

<div>

<% if @product.picture.attached? %>
    
    <%= image_tag @product.picture %> <%# add styling to limit image size later%>
    
<%else %> 
    <%= image_tag "drill.jpg", alt:"power drill"%> 
    
<%end %>

</div>

<div>

<tr>
    <td><h2><%= @product.title %></h2></td> 
    <td><%= link_to "edit", edit_product_path(@product) if current_user.id == @product.user_id %></td>
    <td><%= if current_user.id == @product.user_id 
        link_to "delete", product_path(@product), method: :delete, data: {confirm: "Are you sure?" }
    end %></td>
</tr>

<h1>brand:<%= @product.brand[:name] %></h1>
<h3><%= @product_condition%></h3>
<h2>Description: <%=  @product.description %> </h2>

</div>


<div>
--------------link to buy button---------------
<button data-stripe="payment">Buy <%= number_to_currency(@product.price / 100.0)%></button>
</div>

<script src="https://js.stripe.com/v3/"></script>

<script>
  document
    .querySelector("[data-stripe='payment']")
    .addEventListener("click", () => {
      const stripe = Stripe(
        "<%= Rails.application.credentials.dig(:stripe, :public_key) %>"
      );

      stripe.redirectToCheckout({
        sessionId: "<%= @session_id %>"
      });
    });
</script>